=> wandb run name : resnet18_leuven_bce resnet18_leuven_bce
=> torch version : 1.10.1+cu111
=> ngpus : 2
=> modeling the network resnet18 ...
=> num of params: 40499849 (154M)
=> building the oprimizer ...
=> building the dataloader ...
=> building the criterion ...
=> starting training engine ...
> /home/siddsuresh97/Projects/cs839-autoencoder/models/resnet.py(98)forward()
     97         import ipdb;ipdb.set_trace()
---> 98         x = self.encoder(x)
     99         return x
> /home/siddsuresh97/Projects/cs839-autoencoder/models/resnet.py(98)forward()
     97         import ipdb;ipdb.set_trace()
---> 98         x = self.encoder(x)
     99         return x
torch.Size([128, 2048, 7, 7])
RuntimeError: mat1 and mat2 shapes cannot be multiplied (262144x1 and 2048x2048)
> /home/siddsuresh97/Projects/cs839-autoencoder/models/resnet.py(98)forward()
     97         import ipdb;ipdb.set_trace()
---> 98         x = self.encoder(x)
     99         return x
Sequential(
  (0): AdaptiveAvgPool2d(output_size=(1, 1))
  (1): Linear(in_features=2048, out_features=2048, bias=True)
  (2): ReLU()
  (3): Linear(in_features=2048, out_features=2048, bias=True)
  (4): ReLU()
  (5): Linear(in_features=2048, out_features=2057, bias=True)
)
AdaptiveAvgPool2d(output_size=(1, 1))
tensor([[[[0.7263]],
         [[0.6879]],
         [[0.5633]],
         ...,
         [[1.1261]],
         [[0.7575]],
         [[0.5486]]],
        [[[0.7805]],
         [[0.6022]],
         [[1.1072]],
         ...,
         [[1.6012]],
         [[0.9246]],
         [[1.1789]]],
        [[[0.4059]],
         [[0.6365]],
         [[0.9546]],
         ...,
         [[1.0970]],
         [[0.3782]],
         [[0.5167]]],
        ...,
        [[[0.7617]],
         [[0.4802]],
         [[0.7218]],
         ...,
         [[1.3274]],
         [[0.6405]],
         [[0.8487]]],
        [[[0.6282]],
         [[0.9094]],
         [[0.6197]],
         ...,
         [[0.4795]],
         [[0.7601]],
         [[0.4481]]],
        [[[0.7074]],
         [[0.8298]],
         [[0.5759]],
         ...,
         [[0.2779]],
         [[0.7326]],
         [[0.7780]]]], device='cuda:1', grad_fn=<MeanBackward1>)
torch.Size([128, 2048, 1, 1])
AdaptiveAvgPool2d(output_size=(1, 1))
*** NameError: name 'AdaptiveAvgPool2d' is not defined
*** RuntimeError: CUDA out of memory. Tried to allocate 4096.00 GiB (GPU 1; 23.70 GiB total capacity; 6.31 GiB already allocated; 12.84 GiB free; 9.17 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
torch.Size([128, 2048, 1, 1])
*** TypeError: unsqueeze() missing 1 required positional arguments: "dim"
*** TypeError: unsqueeze() takes 1 positional argument but 2 were given
torch.Size([128, 1, 2048, 1, 1])
torch.Size([128, 2048])
Traceback (most recent call last):
  File "/home/siddsuresh97/Projects/cs839-autoencoder/train.py", line 251, in <module>
    main(args)
  File "/home/siddsuresh97/Projects/cs839-autoencoder/train.py", line 99, in main
    main_worker(ngpus_per_node, args)
  File "/home/siddsuresh97/Projects/cs839-autoencoder/train.py", line 173, in main_worker
    do_train(train_loader, model, criterion, optimizer, epoch, args, leuven_bce_transposed)
  File "/home/siddsuresh97/Projects/cs839-autoencoder/train.py", line 218, in do_train
    output, leuven_output = model(input)
  File "/home/siddsuresh97/packages/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/siddsuresh97/packages/anaconda3/lib/python3.9/site-packages/torch/nn/parallel/data_parallel.py", line 168, in forward
    outputs = self.parallel_apply(replicas, inputs, kwargs)
  File "/home/siddsuresh97/packages/anaconda3/lib/python3.9/site-packages/torch/nn/parallel/data_parallel.py", line 178, in parallel_apply
    return parallel_apply(replicas, inputs, kwargs, self.device_ids[:len(replicas)])
  File "/home/siddsuresh97/packages/anaconda3/lib/python3.9/site-packages/torch/nn/parallel/parallel_apply.py", line 86, in parallel_apply
    output.reraise()
  File "/home/siddsuresh97/packages/anaconda3/lib/python3.9/site-packages/torch/_utils.py", line 434, in reraise
    raise exception
RuntimeError: Caught RuntimeError in replica 0 on device 0.
Original Traceback (most recent call last):
  File "/home/siddsuresh97/packages/anaconda3/lib/python3.9/site-packages/torch/nn/parallel/parallel_apply.py", line 61, in _worker
    output = module(*input, **kwargs)
  File "/home/siddsuresh97/packages/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/siddsuresh97/Projects/cs839-autoencoder/models/resnet.py", line 38, in forward
    leuven_normspace = self.leuven_encoder(x)
  File "/home/siddsuresh97/packages/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/siddsuresh97/Projects/cs839-autoencoder/models/resnet.py", line 98, in forward
    x = self.encoder(x)
  File "/home/siddsuresh97/Projects/cs839-autoencoder/models/resnet.py", line 98, in forward
    x = self.encoder(x)
  File "/home/siddsuresh97/packages/anaconda3/lib/python3.9/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/home/siddsuresh97/packages/anaconda3/lib/python3.9/bdb.py", line 112, in dispatch_line
    self.user_line(frame)
  File "/home/siddsuresh97/packages/anaconda3/lib/python3.9/pdb.py", line 262, in user_line
    self.interaction(frame, None)
  File "/home/siddsuresh97/.local/lib/python3.9/site-packages/IPython/core/debugger.py", line 336, in interaction
    OldPdb.interaction(self, frame, traceback)
  File "/home/siddsuresh97/packages/anaconda3/lib/python3.9/pdb.py", line 357, in interaction
    self._cmdloop()
  File "/home/siddsuresh97/packages/anaconda3/lib/python3.9/pdb.py", line 322, in _cmdloop
    self.cmdloop()
  File "/home/siddsuresh97/.local/lib/python3.9/site-packages/IPython/terminal/debugger.py", line 132, in cmdloop
    line = self.thread_executor.submit(
  File "/home/siddsuresh97/packages/anaconda3/lib/python3.9/concurrent/futures/_base.py", line 446, in result
    return self.__get_result()
  File "/home/siddsuresh97/packages/anaconda3/lib/python3.9/concurrent/futures/_base.py", line 391, in __get_result
    raise self._exception
  File "/home/siddsuresh97/packages/anaconda3/lib/python3.9/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/home/siddsuresh97/.local/lib/python3.9/site-packages/prompt_toolkit/shortcuts/prompt.py", line 1034, in prompt
    return self.app.run(
  File "/home/siddsuresh97/.local/lib/python3.9/site-packages/prompt_toolkit/application/application.py", line 978, in run
    return loop.run_until_complete(
  File "/home/siddsuresh97/packages/anaconda3/lib/python3.9/asyncio/base_events.py", line 647, in run_until_complete
    return future.result()
  File "/home/siddsuresh97/.local/lib/python3.9/site-packages/prompt_toolkit/application/application.py", line 891, in run_async
    await self.cancel_and_wait_for_background_tasks()
  File "/home/siddsuresh97/.local/lib/python3.9/site-packages/prompt_toolkit/application/application.py", line 1092, in cancel_and_wait_for_background_tasks
    await task
RuntimeError: Task <Task pending name='Task-8' coro=<Application.run_async() running at /home/siddsuresh97/.local/lib/python3.9/site-packages/prompt_toolkit/application/application.py:891> cb=[_run_until_complete_cb() at /home/siddsuresh97/packages/anaconda3/lib/python3.9/asyncio/base_events.py:184]> got Future <Task pending name='Task-95' coro=<KeyProcessor._start_timeout.<locals>.wait() running at /home/siddsuresh97/.local/lib/python3.9/site-packages/prompt_toolkit/key_binding/key_processor.py:397> wait_for=<Future pending cb=[<TaskWakeupMethWrapper object at 0x7fbde41dd9d0>()]>> attached to a different loop
If you suspect this is an IPython 8.5.0 bug, please report it at:
    https://github.com/ipython/ipython/issues
or send an email to the mailing list at ipython-dev@python.org
You can print a more detailed traceback right now with "%tb", or use "%debug"
to interactively debug it.
Extra-detailed tracebacks for bug-reporting purposes can be enabled via:
    %config Application.verbose_crash=True
Error in atexit._run_exitfuncs:
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 140453039040064 and this is thread id 140460289767232.
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/siddsuresh97/.local/lib/python3.9/site-packages/IPython/core/history.py", line 831, in writeout_cache
    self._writeout_input_cache(conn)
  File "/home/siddsuresh97/.local/lib/python3.9/site-packages/IPython/core/history.py", line 814, in _writeout_input_cache
    conn.execute("INSERT INTO history VALUES (?, ?, ?, ?)",
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 140453039040064 and this is thread id 140460289767232.
Error in atexit._run_exitfuncs:
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 140453030647360 and this is thread id 140460289767232.
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/siddsuresh97/.local/lib/python3.9/site-packages/IPython/core/history.py", line 831, in writeout_cache
    self._writeout_input_cache(conn)
  File "/home/siddsuresh97/.local/lib/python3.9/site-packages/IPython/core/history.py", line 814, in _writeout_input_cache
    conn.execute("INSERT INTO history VALUES (?, ?, ?, ?)",
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 140453030647360 and this is thread id 140460289767232.